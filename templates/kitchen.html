<!DOCTYPE html>
<html>
<head>
    <title>Yumzo Kitchen</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="header"><h1>KITCHEN LIVE</h1></div>
    <div id="kitchen-feed" style="padding: 20px;"></div>

    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script>
        firebase.initializeApp({projectId: "yumzo-dee28"});
        const db = firebase.firestore();

        db.collection("orders").orderBy("createdAt", "desc").onSnapshot(snap => {
            const feed = document.getElementById('kitchen-feed');
            feed.innerHTML = "";
            snap.forEach(doc => {
                const data = doc.data();
                if(data.status !== "Done") {
                    feed.innerHTML += `
                        <div class="item-card" style="text-align:left; margin-bottom:15px;">
                            <h3>Order #${data.orderNum}</h3>
                            <p>${data.items.map(i => i.name).join(", ")}</p>
                            <button onclick="markDone('${doc.id}')" class="btn-confirm">MARK DONE</button>
                        </div>
                    `;
                }
            });
        });

        function markDone(id) {
            db.collection("orders").doc(id).update({status: "Done"});
        }
    </script>
</body>
</html>
